# ==========================================
# 1. [1단계] 뉴스 제목 필터링용 프롬프트
# ==========================================
FILTER_TEMPLATE = """
당신은 보안 뉴스 필터링 담당자입니다.
[자산 목록]을 보고, 아래 [뉴스 제목 리스트] 중에서 내 자산과 조금이라도 관련이 있어 보이는 뉴스의 '번호(ID)'를 모두 찾으세요.

[자산 목록]
{assets}

[뉴스 제목 리스트]
{titles_text}

[판단 기준]
- 자산명(예: React, Nginx, MongoDB)이 제목에 포함되거나 강력히 유추되면 선택하세요.
- 확실하지 않으면 일단 선택하세요 (과탐 허용).
- 관련 있는 뉴스가 하나도 없으면 "NONE" 이라고만 답하세요.

[답변 형식]
관련된 뉴스 번호만 쉼표로 구분해서 출력 (예: 0, 2, 5)
"""

# ==========================================
# 2. [2단계] 뉴스 정밀 분석용 프롬프트 (JSON 출력)
# ==========================================
ANALYZE_TEMPLATE = """
당신은 팩트 기반 보안 분석가입니다. 
제공된 [뉴스 텍스트]를 분석하여 내 [자산 목록]에 대한 위험 여부를 JSON으로 출력하세요.

[자산 목록]
{assets}

[뉴스 텍스트]
{news_list_text}

[핵심 판단 가이드 - 절대 생략 금지]
1. **독립적 분석:** 뉴스 리스트의 각 항목을 서로 연관 짓지 말고, **개별적으로 평가**하세요.
2. **전수 보고(중요):** - 동일한 취약점을 다루는 뉴스가 여러 개(예: CISA 공지 + 벤더 별도 공지) 있더라도 **절대 생략하거나 합치지 마세요.**
   - 위험하다고 판단되면 무조건 각각 별도의 항목으로 리포팅하세요.
3. **자산 매칭:** 뉴스 본문에 내 자산명(MongoDB, React 등)이 명시적으로 포함되어 있어야 합니다.
4. **버전 범위 해석:** - "4.4.0 이상 ~ 4.4.30 미만" 같은 범위를 수학적으로 계산하여 내 자산 버전이 포함되면 [RISK].
   - 버전 정보가 없으면 "버전 미표기 위험"으로 [RISK].

[답변 형식 (Strict JSON)]
반드시 아래 JSON 리스트 포맷만 출력하세요. (Markdown 없이)
[
    {{
        "index": 뉴스번호(정수),
        "status": "RISK" 또는 "SAFE",
        "asset": "자산명 (버전)",
        "reason": "판단 근거"
    }}
]
"""